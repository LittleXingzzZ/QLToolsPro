import{N as e,k as a,w as t,f as l,a4 as n,a6 as i,c as s,a8 as o,u as r,L as d,a3 as u,r as p,i as m,a1 as c,F as v,a5 as f,J as b,a2 as _}from"./@vue-11129043.js";import{p as h}from"./p-center-modal-60835ea2.js";import"./dayjs-1ff0b700.js";import{v as j,x as g,y,z as x,A as C,B as k,C as D,D as I,E as U}from"./index-180795d1.js";import{n as w,d as P}from"./common-2c0ac4fc.js";import{m as S,F as O,E}from"./ant-design-vue-cc438dd6.js";import{_ as F}from"./page-container-6fc30811.js";import{c as A}from"./count-animation-bcd27352.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-38971876.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ant-design-477981d5.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";import"./gsap-fedcb77b.js";const q=d("取消"),L=d("提交"),V={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(d,{emit:p}){const m=d,{visible:c,dataObj:v}=e(m),f=()=>{p("update:visible",!1)},b=a({name:"",url:"",id:"",secret:"",panel_enable:!0,panel_version:!1}),_={name:[{required:!0,trigger:"change"}],url:[{required:!0,trigger:"change"}],id:[{required:!0,trigger:"change"}],secret:[{required:!0,trigger:"change"}]},y=e=>{},x=(...e)=>{},C={labelCol:{span:7},wrapperCol:{span:15}},k=e=>{let a={},t=null;v.value.ID?(a={id:v.value.ID,name:b.name,url:b.url,client_id:b.id,client_secret:b.secret,panel_enable:b.panel_enable,panel_version:b.panel_version},t=j):(a={...b},t=g),t({data:a}).then((()=>{S.success("操作成功"),p("updateData",a),f()}))};t(c,((e,a,t)=>{c.value&&D()}));const D=()=>{"面板编辑"===v.value.title?(b.name=v.value.PanelName,b.url=v.value.PanelURL,b.id=w(v.value.PanelClientID),b.secret=v.value.PanelClientSecret,b.panel_enable=v.value.PanelEnable,b.panel_version=v.value.PanelVersion):(b.name="",b.url="",b.id="",b.secret="",b.panel_enable=!1,b.panel_version=!1)};return(e,a)=>{const t=u("a-input"),d=u("a-form-item"),p=u("a-switch"),m=u("a-divider"),j=u("a-button"),g=u("a-form");return l(),n(h,{modalVisible:r(c),isFooter:!1,onClose:f,title:r(v).title},{content:i((()=>[s(g,o({ref:"formRef",name:"custom-validation",model:b,rules:_},C,{onValidate:x,onFinishFailed:y,onFinish:k}),{default:i((()=>[s(d,{label:"面板名称",name:"name"},{default:i((()=>[s(t,{value:b.name,"onUpdate:value":a[0]||(a[0]=e=>b.name=e)},null,8,["value"])])),_:1}),s(d,{label:"面板连接地址",name:"url"},{default:i((()=>[s(t,{value:b.url,"onUpdate:value":a[1]||(a[1]=e=>b.url=e)},null,8,["value"])])),_:1}),s(d,{label:"面板Client_ID",name:"id"},{default:i((()=>[s(t,{value:b.id,"onUpdate:value":a[2]||(a[2]=e=>b.id=e)},null,8,["value"])])),_:1}),s(d,{label:"面板Client_Secret",name:"secret"},{default:i((()=>[s(t,{value:b.secret,"onUpdate:value":a[3]||(a[3]=e=>b.secret=e)},null,8,["value"])])),_:1}),s(d,{label:"是否启用",name:"panel_enable"},{default:i((()=>[s(p,{checked:b.panel_enable,"onUpdate:checked":a[4]||(a[4]=e=>b.panel_enable=e),"checked-children":"是","un-checked-children":"否"},null,8,["checked"])])),_:1}),s(d,{label:"版本",name:"panel_version"},{default:i((()=>[s(p,{checked:b.panel_version,"onUpdate:checked":a[5]||(a[5]=e=>b.panel_version=e),"checked-children":"旧","un-checked-children":"新"},null,8,["checked"])])),_:1}),s(m),s(d,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:i((()=>[s(j,{onClick:f},{default:i((()=>[q])),_:1}),s(j,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:i((()=>[L])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible","title"])}}},R=d("取消"),z=d("提交"),K={__name:"bindVariable",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(b,{emit:_}){const j=b,{visible:g,dataObj:C}=e(j),k=()=>{_("update:visible",!1)},D=a({name:[]}),I={name:[{required:!0,trigger:"change",message:"请选择变量名称"}]},U=e=>{},P=(...e)=>{},O={labelCol:{span:7},wrapperCol:{span:15}},E=e=>{let a={};a={id:C.value.ID,env_binding:D.name.map((e=>w(e)))},x({data:a}).then((()=>{S.success("操作成功"),_("updateData",a),k()}))};t(g,((e,a,t)=>{g.value&&F()}));const F=()=>{D.name=(C.value.EnvBinding||"").split(","),q()},A=p([]),q=()=>{y({splicingData:{page:1,quantity:100}}).then((e=>{A.value=(e.pageData||[]).map((e=>(e.label=e.EnvRemarks||e.EnvName,e.value=w(e.ID),e)))}))};return(e,a)=>{const t=u("a-checkbox"),p=u("a-col"),b=u("a-row"),_=u("a-checkbox-group"),j=u("a-form-item"),y=u("a-divider"),x=u("a-button"),C=u("a-form");return l(),n(h,{modalVisible:r(g),isFooter:!1,onClose:k,title:"绑定变量"},{content:i((()=>[s(C,o({ref:"formRef",name:"custom-validation",model:D,rules:I},O,{onValidate:P,onFinishFailed:U,onFinish:E}),{default:i((()=>[s(j,{label:"变量名称",name:"name"},{default:i((()=>[s(_,{value:D.name,"onUpdate:value":a[0]||(a[0]=e=>D.name=e),style:{width:"100%"}},{default:i((()=>[s(b,null,{default:i((()=>[(l(!0),m(v,null,c(A.value,((e,a)=>(l(),n(p,{span:8,key:a},{default:i((()=>[s(t,{value:e.value},{default:i((()=>[d(f(e.label),1)])),_:2},1032,["value"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),s(y),s(j,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:i((()=>[s(x,{onClick:k},{default:i((()=>[R])),_:1}),s(x,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:i((()=>[z])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible"])}}},N=d(" 创建面板 "),B=d(" 是否确认解除？ "),H=d(" 解除所有变量绑定 "),T=d(" 是否确认更新？ "),M=d(" 批量更新Token "),G={key:1},J=d("修改 "),Q=d(" 是否确认删除？ "),W=d("删除 "),X=d("绑定变量 "),Y=d("测试链接 "),Z={__name:"index",setup(e){const t=p({}),o=p({}),r=p(!1),d=p(!1),c=O.useForm,f=p(0),h=p(1),j=p(10);E.PRESENTED_IMAGE_SIMPLE;const g=a({invoiceSeq:"",userPhone:"",operationUser:""});c(g);const y=[{title:"面板ID",dataIndex:"ID",width:120},{title:"名称",dataIndex:"PanelName",width:200},{title:"连接地址",dataIndex:"PanelURL",width:200},{title:"Client_ID",dataIndex:"PanelClientID",customKey:"isHide",width:200},{title:"Client_Secret",dataIndex:"PanelClientSecret",customKey:"isHide",width:200},{title:"操作时间",dataIndex:"UpdatedAt",width:280},{title:"操作",dataIndex:"operation",customKey:"operation",fixed:"right",width:150}],x=p([]),w=e=>{r.value=!0,o.value=e?{...e,title:"面板编辑"}:{title:"面板新增"}},q=e=>{e&&(h.value=1),C({data:g,splicingData:{page:h.value,quantity:j.value}}).then((e=>{f.value=(e.pageData||[]).length,x.value=(e.pageData||[]).map((e=>(e.CreatedAt&&(e.CreatedAt=P(e.CreatedAt)),e.UpdatedAt&&(e.UpdatedAt=P(e.UpdatedAt)),e)))}))};return(e,a)=>{const p=u("a-button"),c=u("a-popconfirm"),C=u("a-form-item"),P=u("a-form");return l(),m(v,null,[s(V,{visible:r.value,"onUpdate:visible":a[0]||(a[0]=e=>r.value=e),onUpdateData:q,dataObj:o.value},null,8,["visible","dataObj"]),s(K,{visible:d.value,"onUpdate:visible":a[1]||(a[1]=e=>d.value=e),onUpdateData:q,dataObj:t.value},null,8,["visible","dataObj"]),s(F,{columns:y,pageSize:j.value,"onUpdate:pageSize":a[5]||(a[5]=e=>j.value=e),current:h.value,"onUpdate:current":a[6]||(a[6]=e=>h.value=e),total:f.value,"onUpdate:total":a[7]||(a[7]=e=>f.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:q,onInitData:q,dataSource:x.value},{search:i((()=>[s(P,{class:"flex flex-warp",model:g},{default:i((()=>[s(C,null,{default:i((()=>[s(p,{type:"primary",onClick:a[2]||(a[2]=b((e=>w()),["prevent"])),class:"filter-search"},{default:i((()=>[N])),_:1}),s(c,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:a[3]||(a[3]=e=>{k().then((()=>{S.success("操作成功!"),q(!0)}))})},{title:i((()=>[B])),default:i((()=>[s(p,{type:"primary",shape:"round",style:{"margin-left":"10px"}},{default:i((()=>[H])),_:1})])),_:1}),s(c,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:a[4]||(a[4]=e=>{D().then((()=>{S.success("操作成功!"),q(!0)}))})},{title:i((()=>[T])),default:i((()=>[s(p,{type:"primary",shape:"round",style:{"margin-left":"10px"}},{default:i((()=>[M])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),bodyCell:i((({text:e,record:a,index:o,column:r})=>["money"===r.customKey?(l(),n(A,{key:0,num:e},null,8,["num"])):_("",!0),"isHide"===r.customKey?(l(),m("span",G,"************")):_("",!0),"operation"===r.customKey?(l(),m(v,{key:2},[s(p,{type:"primary",onClick:b((e=>w(a)),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:i((()=>[J])),_:2},1032,["onClick"]),s(c,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{I({data:{id:[a.ID]}}).then((()=>{S.success("操作成功!"),q(!0)}))}},{title:i((()=>[Q])),default:i((()=>[s(p,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:i((()=>[W])),_:1})])),_:2},1032,["onConfirm"]),s(p,{type:"primary",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round",onClick:e=>{return l=a,t.value=l,void(d.value=!0);var l}},{default:i((()=>[X])),_:2},1032,["onClick"]),s(p,{type:"primary",onClick:b((e=>{var t;U({data:{name:(t=a).PanelName,url:t.PanelURL,id:t.PanelClientID,secret:t.PanelClientSecret}}).then((()=>{S.success("面板连接测试成功!")}))}),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:i((()=>[Y])),_:2},1032,["onClick"])],64)):_("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{Z as default};
