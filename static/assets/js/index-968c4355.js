import{N as e,k as a,w as t,f as l,a4 as r,a6 as s,c as i,a8 as o,u as n,L as p,a3 as u,r as d,i as m,F as c,J as v,a2 as f}from"./@vue-11129043.js";import{p as b}from"./p-center-modal-440646c4.js";import"./dayjs-1ff0b700.js";import{M as j,N as _,O as y}from"./index-5b2bc764.js";import{m as g,F as h,E as k}from"./ant-design-vue-cc438dd6.js";import{_ as x}from"./page-container-7fa4b6af.js";import{d as C}from"./common-2c0ac4fc.js";import{S as U,ak as I}from"./@ant-design-477981d5.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-d3bd5447.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";const S=p("取消"),w=p("提交"),A={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(p,{emit:d}){const m=p,{visible:c,dataObj:v}=e(m),f=()=>{d("update:visible",!1)},_=a({remarks:"",value:""}),y={value:[{required:!0,trigger:"change"}],remarks:[{required:!0,trigger:"change"}]},h=e=>{},k=(...e)=>{},x={labelCol:{span:7},wrapperCol:{span:15}},C=e=>{const a={..._,panel_name:v.value.panel_name,id:v.value.id,_id:v.value._id,name:v.value.name};j({data:a}).then((()=>{g.success("操作成功"),d("updateData",a),f()}))};t(c,((e,a,t)=>{c.value&&U()}));const U=()=>{_.remarks=v.value.remarks||"",_.value=v.value.value||""};return(e,a)=>{const t=u("a-input"),p=u("a-form-item"),d=u("a-divider"),m=u("a-button"),v=u("a-form");return l(),r(b,{modalVisible:n(c),isFooter:!1,onClose:f,title:"变量修改"},{content:s((()=>[i(v,o({ref:"formRef",name:"custom-validation",model:_,rules:y},x,{onValidate:k,onFinishFailed:h,onFinish:C}),{default:s((()=>[i(p,{label:"变量值",name:"value"},{default:s((()=>[i(t,{value:_.value,"onUpdate:value":a[0]||(a[0]=e=>_.value=e)},null,8,["value"])])),_:1}),i(p,{label:"变量备注",name:"remarks"},{default:s((()=>[i(t,{value:_.remarks,"onUpdate:value":a[1]||(a[1]=e=>_.remarks=e)},null,8,["value"])])),_:1}),i(d),i(p,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:s((()=>[i(m,{onClick:f},{default:s((()=>[S])),_:1}),i(m,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:s((()=>[w])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible"])}}},D=p("面板"),F=p("用户"),O=p(" 搜索 "),E=p("重置 "),z=p("修改 "),q=p(" 是否确认删除？ "),L=p("删除 "),M={__name:"index",setup(e){const t=d({}),r=d({}),o=d(!1),p=h.useForm,b=d(0),j=d(1),S=d(10);k.PRESENTED_IMAGE_SIMPLE;const w=a({s:"",type:"panel"}),M=d(!1),{resetFields:N,validate:V,validateInfos:K}=p(w),P=[{title:"面板名称",dataIndex:"panel_name",width:200},{title:"变量名称",dataIndex:"name",key:"name"},{title:"变量值",dataIndex:"value",key:"value"},{title:"上传用户",dataIndex:"remarks",key:"remarks"},{title:"操作",dataIndex:"operation",customKey:"operation"}],R=d([]),T=d([]),B=()=>{let e=j.value*S.value;e>b.value&&(e=b.value),R.value=T.value.slice((j.value-1)*S.value,e)},G=e=>{if(e&&(j.value=1),"panel"==w.type&&!w.s)return void g.error("请输入面板ID");let a=r.value;a.page=j.value,a.quantity=S.value,_({data:w,splicingData:a}).then((e=>{T.value=e.filter((e=>e.panel_env&&e.panel_name)).map((e=>e.panel_env?e.panel_env.map((a=>(a.panel_name=e.panel_name,a.CreatedAt&&(a.CreatedAt=C(a.CreatedAt)),a.UpdatedAt&&(a.UpdatedAt=C(a.UpdatedAt)),a))):[])).flat(),b.value=T.value.length,B()}))};r.value=w;const J=()=>{N(),M.value=!1,G(!0)},H=()=>{V().then((e=>{r.value=w,G(!0)})).catch((e=>{}))};return(e,a)=>{const r=u("a-radio"),p=u("a-radio-group"),d=u("a-form-item"),_=u("a-input"),h=u("a-button"),k=u("a-form"),C=u("a-popconfirm");return l(),m(c,null,[i(A,{visible:o.value,"onUpdate:visible":a[0]||(a[0]=e=>o.value=e),onUpdateData:a[1]||(a[1]=e=>G(!0)),dataObj:t.value},null,8,["visible","dataObj"]),i(x,{columns:P,pageSize:S.value,"onUpdate:pageSize":a[4]||(a[4]=e=>S.value=e),current:j.value,"onUpdate:current":a[5]||(a[5]=e=>j.value=e),total:b.value,"onUpdate:total":a[6]||(a[6]=e=>b.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:B,onInitData:a[7]||(a[7]=()=>{}),dataSource:R.value},{search:s((()=>[i(k,{class:"flex flex-warp",model:w},{default:s((()=>[i(d,{label:"搜索类型:",name:"type"},{default:s((()=>[i(p,{value:w.type,"onUpdate:value":a[2]||(a[2]=e=>w.type=e)},{default:s((()=>[i(r,{value:"panel",name:"panel"},{default:s((()=>[D])),_:1}),i(r,{value:"user",name:"user"},{default:s((()=>[F])),_:1})])),_:1},8,["value"])])),_:1}),i(d,{label:"关键字:",name:"s"},{default:s((()=>[i(_,{value:w.s,"onUpdate:value":a[3]||(a[3]=e=>w.s=e),placeholder:"panel"==w.type?"请输入面板ID":"请输入用户名"},null,8,["value","placeholder"])])),_:1}),i(d,null,{default:s((()=>[i(h,{type:"primary",onClick:v(H,["prevent"]),class:"filter-search"},{default:s((()=>[i(n(U)),O])),_:1},8,["onClick"]),i(h,{style:{"margin-left":"10px"},class:"filter-reset",onClick:J},{default:s((()=>[i(n(I)),E])),_:1})])),_:1})])),_:1},8,["model"])])),bodyCell:s((({text:e,record:a,index:r,column:n})=>["operation"===n.customKey?(l(),m(c,{key:0},[i(h,{type:"primary",onClick:v((e=>{return l=a,o.value=!0,void(t.value=l?{...l,title:"面板编辑"}:{title:"面板新增"});var l}),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:s((()=>[z])),_:2},1032,["onClick"]),i(C,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{var t;y({data:{panel_name:(t=a).panel_name,id:t.id,_id:t._id}}).then((()=>{g.success("操作成功!"),G(!0)}))}},{title:s((()=>[q])),default:s((()=>[i(h,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:s((()=>[L])),_:1})])),_:2},1032,["onConfirm"])],64)):f("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{M as default};
