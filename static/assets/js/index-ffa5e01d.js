import{N as e,r as a,k as t,s as n,B as l,w as i,f as d,a4 as o,a6 as r,c as s,a2 as u,_ as v,u as p,a8 as m,L as _,a3 as c,i as g,F as f,J as h}from"./@vue-11129043.js";import{T as b,E as y}from"./@wangeditor-c98dfed2.js";import{p as j}from"./p-center-modal-440646c4.js";import"./dayjs-1ff0b700.js";import{T as x,U as E,V as I,y as k,W as w,X as U}from"./index-5b2bc764.js";import{n as C,s as S,d as q}from"./common-2c0ac4fc.js";import{m as D,F as N,E as A}from"./ant-design-vue-cc438dd6.js";import{c as M}from"./count-animation-bcd27352.js";import{_ as O}from"./page-container-7fa4b6af.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-d3bd5447.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ant-design-477981d5.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";import"./gsap-fedcb77b.js";const V=_("新建模式"),P=_("更新模式"),F=v("span",null,"合并模式下VIP提交不支持会员到期后自动删除变量",-1),R=_(" 合并模式"),T=v("span",{style:{color:"red"}}," ？",-1),z=_("不计费"),K=_("VIP提交"),L=_("积分提交"),B={style:{border:"1px solid #ccc"}},Q={class:"form-bottom"},G=_("取消"),H=_("提交"),J={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(_,{emit:g}){const f=_,{visible:h,dataObj:k}=e(f),w=a(0),U=()=>{g("update:visible",!1)},q=t({env_merge:"",env_name:"",env_remarks:"",env_quantity:"",env_regex:"",env_mode:"1",env_update:"",env_is_plugin:!1,env_plugin_name:"",env_is_charging:"1",env_need_integral:""}),N={env_name:[{required:!0,trigger:"change"}],env_quantity:[{required:!0,trigger:"change"}],env_mode:[{required:!0,trigger:"change"}],env_is_plugin:[{required:!0,trigger:"change"}],env_is_charging:[{required:!0,trigger:"change"}]},A=a([]),M=(e,a)=>a.label.indexOf(e)>=0,O=e=>{},J=(...e)=>{},W={labelCol:{span:7},wrapperCol:{span:15}},X=n(),Y={excludeKeys:["group-video","group-image","headerSelect","italic","group-more-style"]},Z={placeholder:"请输入变量提示内容..."},$=e=>{X.value=e};l((()=>{const e=X.value;null!=e&&e.destroy()}));const ee=e=>{3!=q.env_mode&&(q.env_merge=""),q.env_is_plugin||(q.env_plugin_name="");const a={...q};let t=null;k.value.ID?(a.id=k.value.ID,t=E):t=I,a.env_mode=S(a.env_mode),a.env_is_charging=S(a.env_is_charging),a.env_need_integral=S(a.env_need_integral),t({data:a}).then((()=>{D.success("操作成功"),g("updateData",a),U()}))};i(h,((e,a,t)=>{h.value&&ae()}));const ae=()=>{w.value=.8*document.body.clientHeight,x({splicingData:{type:"ordinary"}}).then((e=>{A.value=(e||[]).map((e=>(e.label=e.plugin_name,e.value=e.file_name,e)))})),k.value.ID?(q.env_tips=k.value.EnvTips||"",q.env_merge=k.value.EnvMerge||k.value.env_merge||"",q.env_name=k.value.EnvName,q.env_remarks=k.value.EnvRemarks,q.env_quantity=k.value.EnvQuantity,q.env_regex=k.value.EnvRegex,q.env_mode=C(k.value.EnvMode),q.env_update=k.value.EnvUpdate,q.env_is_plugin=k.value.EnvIsPlugin,q.env_plugin_name=k.value.EnvPluginName,q.env_is_charging=C(k.value.EnvIsCharging),q.env_need_integral=C(k.value.EnvNeedIntegral)):(q.env_tips="",q.env_merge="",q.env_name="",q.env_remarks="",q.env_quantity="",q.env_regex="",q.env_mode="1",q.env_update="",q.env_is_plugin=!1,q.env_plugin_name="",q.env_is_charging="1",q.env_need_integral="")};return(e,a)=>{const t=c("a-input"),n=c("a-form-item"),l=c("a-input-number"),i=c("a-radio"),_=c("a-tooltip"),g=c("a-radio-group"),f=c("a-switch"),x=c("a-select"),E=c("a-divider"),I=c("a-button"),w=c("a-form");return d(),o(j,{modalVisible:p(h),isFooter:!1,onClose:U,title:p(k).title},{content:r((()=>[s(w,m({ref:"formRef",class:"form-ref",name:"custom-validation",model:q,rules:N},W,{onValidate:J,onFinishFailed:O,onFinish:ee}),{default:r((()=>[s(n,{label:"变量名",name:"env_name"},{default:r((()=>[s(t,{value:q.env_name,"onUpdate:value":a[0]||(a[0]=e=>q.env_name=e),placeholder:"请输入变量名"},null,8,["value"])])),_:1}),s(n,{label:"环境变量名称备注",name:"env_remarks"},{default:r((()=>[s(t,{value:q.env_remarks,"onUpdate:value":a[1]||(a[1]=e=>q.env_remarks=e),placeholder:"请输入环境变量名称备注"},null,8,["value"])])),_:1}),s(n,{label:"环境变量数量上限",name:"env_quantity"},{default:r((()=>[s(l,{value:q.env_quantity,"onUpdate:value":a[2]||(a[2]=e=>q.env_quantity=e),placeholder:"请输入环境变量数量上限",style:{},min:"0"},null,8,["value"])])),_:1}),s(n,{label:"环境变量匹配正则",name:"env_regex"},{default:r((()=>[s(t,{value:q.env_regex,"onUpdate:value":a[3]||(a[3]=e=>q.env_regex=e),placeholder:"请输入环境变量匹配正则"},null,8,["value"])])),_:1}),s(n,{label:"环境变量模式",name:"env_mode"},{default:r((()=>[s(g,{value:q.env_mode,"onUpdate:value":a[4]||(a[4]=e=>q.env_mode=e)},{default:r((()=>[s(i,{value:"1",name:"type"},{default:r((()=>[V])),_:1}),s(i,{value:"2",name:"type"},{default:r((()=>[P])),_:1}),s(i,{value:"3",name:"type"},{default:r((()=>[s(_,{placement:"top"},{title:r((()=>[F])),default:r((()=>[R,T])),_:1})])),_:1})])),_:1},8,["value"])])),_:1}),3==q.env_mode?(d(),o(n,{key:0,label:"环境变量分隔符",name:"env_merge"},{default:r((()=>[s(t,{value:q.env_merge,"onUpdate:value":a[5]||(a[5]=e=>q.env_merge=e),placeholder:"请输入环境变量分隔符"},null,8,["value"])])),_:1})):(d(),o(n,{key:1,label:"环境变量更新匹配正则",name:"env_update"},{default:r((()=>[s(t,{value:q.env_update,"onUpdate:value":a[6]||(a[6]=e=>q.env_update=e),placeholder:"请输入环境变量更新匹配正则"},null,8,["value"])])),_:1})),s(n,{label:"环境变量是否使用插件",name:"env_is_plugin"},{default:r((()=>[s(f,{checked:q.env_is_plugin,"onUpdate:checked":a[7]||(a[7]=e=>q.env_is_plugin=e),"checked-children":"是","un-checked-children":"否"},null,8,["checked"])])),_:1}),q.env_is_plugin?(d(),o(n,{key:2,label:"绑定的插件名称",name:"env_plugin_name"},{default:r((()=>[s(x,{value:q.env_plugin_name,"onUpdate:value":a[8]||(a[8]=e=>q.env_plugin_name=e),placeholder:"请选择","filter-option":M,"show-search":"","option-label-prop":"label",options:A.value},null,8,["value","options"])])),_:1})):u("",!0),s(n,{label:"环境变量是否计费",name:"env_is_charging"},{default:r((()=>[s(g,{value:q.env_is_charging,"onUpdate:value":a[9]||(a[9]=e=>q.env_is_charging=e)},{default:r((()=>[s(i,{value:"1",name:"type"},{default:r((()=>[z])),_:1}),s(i,{value:"2",name:"type"},{default:r((()=>[K])),_:1}),s(i,{value:"3",name:"type"},{default:r((()=>[L])),_:1})])),_:1},8,["value"])])),_:1}),s(n,{label:"环境变量积分提交需要多少积分",name:"env_need_integral"},{default:r((()=>[s(l,{value:q.env_need_integral,"onUpdate:value":a[10]||(a[10]=e=>q.env_need_integral=e),style:{},placeholder:"请输入环境变量积分提交需要多少积分",min:"0"},null,8,["value"])])),_:1}),s(n,{label:"变量提示内容",name:"env_tips"},{default:r((()=>[v("div",B,[s(p(b),{style:{"border-bottom":"1px solid #ccc"},editor:p(X),defaultConfig:Y,mode:e.mode},null,8,["editor","mode"]),s(p(y),{style:{height:"300px","overflow-y":"hidden"},modelValue:q.env_tips,"onUpdate:modelValue":a[11]||(a[11]=e=>q.env_tips=e),defaultConfig:Z,mode:e.mode,onOnCreated:$},null,8,["modelValue","mode"])])])),_:1}),v("div",Q,[s(E),s(n,{"wrapper-col":{span:9,offset:12},class:"timed-start-button"},{default:r((()=>[s(I,{onClick:U},{default:r((()=>[G])),_:1}),s(I,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:r((()=>[H])),_:1})])),_:1})])])),_:1},16,["model"])])),_:1},8,["modalVisible","title"])}}},W=_(" 新增 "),X=_(" 是否确认刷新缓存？ "),Y=_("手动刷新缓存 "),Z=_("修改 "),$=_(" 是否确认删除？ "),ee=_("删除 "),ae={__name:"index",setup(e){const n=a({}),l=a(!1),i=N.useForm,v=a(0),p=a(1),m=a(10);A.PRESENTED_IMAGE_SIMPLE;const _=t({s:""}),b=a(!1);i(_);const y=[{title:"ID",dataIndex:"ID",fixed:"left",width:120},{title:"变量名",dataIndex:"EnvName",width:200},{title:"变量备注",dataIndex:"EnvRemarks",width:200},{title:"变量限额",dataIndex:"EnvQuantity",width:200},{title:"变量提交正则",dataIndex:"EnvRegex",width:200},{title:"变量模式",dataIndex:"EnvModeStr",width:200},{title:"变量更新匹配正则",dataIndex:"EnvUpdate",width:200},{title:"变量是否使用插件",dataIndex:"EnvIsPlugin",width:200},{title:"变量绑定的插件名称",dataIndex:"EnvPluginName",width:280},{title:"变量是否计费",dataIndex:"EnvIsCharging",width:280},{title:"变量提交积分扣额",dataIndex:"EnvNeedIntegral",width:280},{title:"变量提示内容",dataIndex:"EnvTips",width:280},{title:"操作时间",dataIndex:"UpdatedAt",width:280},{title:"操作",dataIndex:"operation",customKey:"operation",fixed:"right",width:300}],j=a([]),x=()=>{w()},E=e=>{l.value=!0,n.value=e?{...e,title:"变量编辑"}:{title:"变量新增"}},I=e=>{e&&(p.value=1);let a={page:p.value,quantity:m.value};k({data:_,splicingData:a}).then((e=>{b.value?v.value=0:v.value=e.page*m.value,j.value=(e.pageData||e||[]).map((e=>{switch(e.CreatedAt&&(e.CreatedAt=q(e.CreatedAt)),e.UpdatedAt&&(e.UpdatedAt=q(e.UpdatedAt)),e.EnvMode){case 1:case"1":e.EnvModeStr="新建模式";break;case 2:case"2":e.EnvModeStr="更新模式";break;default:e.EnvModeStr="合并模式"}return e.EnvIsCharging=e.EnvIsCharging||"——",e.EnvNeedIntegral=e.EnvNeedIntegral||"——",e}))}))};return(e,a)=>{const t=c("a-button"),i=c("a-form-item"),b=c("a-popconfirm"),k=c("a-form");return d(),g(f,null,[s(J,{visible:l.value,"onUpdate:visible":a[0]||(a[0]=e=>l.value=e),onUpdateData:a[1]||(a[1]=e=>I(!0)),dataObj:n.value},null,8,["visible","dataObj"]),s(O,{columns:y,pageSize:m.value,"onUpdate:pageSize":a[3]||(a[3]=e=>m.value=e),current:p.value,"onUpdate:current":a[4]||(a[4]=e=>p.value=e),total:v.value,"onUpdate:total":a[5]||(a[5]=e=>v.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:I,onInitData:I,dataSource:j.value},{search:r((()=>[s(k,{class:"flex flex-warp",model:_},{default:r((()=>[s(i,null,{default:r((()=>[s(t,{type:"primary",onClick:a[2]||(a[2]=h((e=>E()),["prevent"])),class:"filter-search"},{default:r((()=>[W])),_:1})])),_:1}),s(b,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:x},{title:r((()=>[X])),default:r((()=>[s(t,{type:"danger",style:{"margin-left":"10px"},shape:"round"},{default:r((()=>[Y])),_:1})])),_:1})])),_:1},8,["model"])])),bodyCell:r((({text:e,record:a,index:n,column:l})=>["money"===l.customKey?(d(),o(M,{key:0,num:e},null,8,["num"])):u("",!0),"operation"===l.customKey?(d(),g(f,{key:1},[s(t,{type:"primary",onClick:h((e=>E(a)),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:r((()=>[Z])),_:2},1032,["onClick"]),s(b,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{U({data:{id:[a.ID]}}).then((()=>{D.success("操作成功!"),I(!0)}))}},{title:r((()=>[$])),default:r((()=>[s(t,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:r((()=>[ee])),_:1})])),_:2},1032,["onConfirm"])],64)):u("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{ae as default};
