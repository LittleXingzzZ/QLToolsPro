import{s as e}from"./pinia-1ca0c29b.js";import{c as a}from"./store-d3bd5447.js";import{_ as t}from"./_plugin-vue_export-helper-9b9a8a5b.js";import{d as l,N as n,r as s,o as i,a3 as v,f as u,i as o,_ as r,a5 as d,U as p,c,F as m,$ as f,k as h,a6 as g,a8 as b,L as y}from"./@vue-11129043.js";import{u as D,p as _,i as E,j as x}from"./index-5b2bc764.js";import{m as N}from"./ant-design-vue-cc438dd6.js";const C=l({props:{isWatch:{type:Boolean,default:!0},title:{type:String,default:""},isLoad:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},data:{type:Array,default:[1]}},setup(t,l){const{siteSettings:v}=e(a),{title:u,isLoad:o,loading:r,data:d,isWatch:p}=n(t),c=s(null),m=s(0),f=s(0);return p.value&&(i((()=>{m.value=c.value.offsetHeight,f.value=c.value.offsetWidth})),window.addEventListener("resize",(()=>{c.value&&c.value.offsetHeight&&(m.value=0,setTimeout((()=>{m.value=c.value.offsetHeight,f.value=c.value.offsetWidth}),1e3))}))),{siteSettings:v,contentWidth:f,contentHeight:m,myRef:c,title:u,isLoad:o,loading:r}}}),k={class:"container-title"},I={class:"container-title-content"},w={class:"title-text flex content-between"},q={class:"tilte-left"},T={class:"container-table flex-base flex flex-column",ref:"myRef"},U={key:0,class:"load-spin flex align-items flex-base"},j={key:1,class:"flex-base flex align-items p-no-data"};const H=t(C,[["render",function(e,a,t,l,n,s){const i=v("a-spin"),h=v("a-empty");return u(),o("div",{class:f(["flex flex-column pc-container",e.siteSettings.web_bg?"pc-box-bg":""])},[r("div",k,[r("div",I,[r("div",w,[r("div",q,d(e.title),1),p(e.$slots,"title")])])]),r("div",T,[!e.contentHeight||e.isLoad&&e.loading?(u(),o("div",U,[c(i)])):(u(),o(m,{key:1},[e.contentHeight&&e.data.length?p(e.$slots,"content",{key:0,width:e.contentWidth,height:e.contentHeight}):(u(),o("div",j,[c(h)]))],64))],512)],2)}]]),L=y("提交"),W={__name:"upload-data",emits:["tipChange"],setup(e,{emit:a}){const t=D(),l=s(!1),n=s(""),i=s(""),r=s(""),d={labelCol:{span:4},wrapperCol:{span:18}},p={serverID:[{required:!0,trigger:"change",message:"请输入服务器ID!"}],envName:[{required:!0,message:"请输入变量名!",trigger:"change"}]},f=s(0),y=s([]),C=s([]),k=h({serverID:"",envName:"",envData:""}),I=()=>{r.value?_({data:{cdk:r.value}}).then((e=>{N.success("更新CD-KEY密钥成功!"),l.value=!1})):N.error("请输入CD-KEY密钥！")},w=e=>{E({data:{server_id:k.serverID,env_name:k.envName,env_data:k.envData}}).then((e=>{t.getUserSmsInfo(!0),N.success("变量提交成功")})).catch((e=>{}))},q=e=>{},T=(e,a)=>a.label.indexOf(e)>=0,U=(e,t)=>{k.envName="",f.value="",C.value=[],n.value="",a("tipChange",n.value);try{C.value=t.envData.map((e=>({label:e.EnvRemarks||e.EnvName,value:e.EnvName,quantity:e.EnvQuantity,EnvTips:e.EnvTips}))),k.envName=C.value[0].value,f.value=C.value[0].quantity,n.value=C.value[0].EnvTips,a("tipChange",n.value)}catch(l){}},j=(e,t)=>{f.value="",f.value=t.quantity,a("tipChange",t.EnvTips)};return x({}).then((e=>{y.value=e.online.map((e=>({label:e.PanelName,value:e.id,envData:e.env_data}))),k.serverID=y.value[0].value;try{C.value=y.value[0].envData.map((e=>({label:e.EnvRemarks||e.EnvName,value:e.EnvName,quantity:e.EnvQuantity,EnvTips:e.EnvTips}))),k.envName=C.value[0].value,f.value=C.value[0].quantity,n.value=C.value[0].EnvTips,a("tipChange",n.value)}catch(t){}})),(e,a)=>{const t=v("a-select"),n=v("a-form-item"),s=v("a-input"),h=v("a-textarea"),D=v("a-button"),_=v("a-form"),E=v("a-modal");return u(),o(m,null,[c(_,b({model:k,name:"basic"},d,{onFinish:w,rules:p,onFinishFailed:q}),{default:g((()=>[c(n,{label:"服务器:",name:"serverID"},{default:g((()=>[c(t,{value:k.serverID,"onUpdate:value":a[0]||(a[0]=e=>k.serverID=e),placeholder:"请选择","filter-option":T,"show-search":"",onChange:U,"option-label-prop":"label",options:y.value},null,8,["value","options"])])),_:1}),c(n,{label:"变量组:",name:"envName"},{default:g((()=>[c(t,{value:k.envName,"onUpdate:value":a[1]||(a[1]=e=>k.envName=e),placeholder:"请选择","filter-option":T,"show-search":"",onChange:j,"option-label-prop":"label",options:C.value},null,8,["value","options"])])),_:1}),c(n,{label:"剩余位置",name:"serverID","has-feedback":""},{default:g((()=>[c(s,{value:f.value,"onUpdate:value":a[2]||(a[2]=e=>f.value=e),disabled:!0},null,8,["value"])])),_:1}),c(n,{name:"envData",label:"变量值","has-feedback":"",rules:[{required:!0,message:"请输入变量值!"}]},{default:g((()=>[c(h,{value:k.envData,"onUpdate:value":a[3]||(a[3]=e=>k.envData=e),placeholder:"请输入变量值!"},null,8,["value"])])),_:1}),c(n,{"wrapper-col":{offset:4,span:18}},{default:g((()=>[c(D,{type:"primary","html-type":"submit"},{default:g((()=>[L])),_:1})])),_:1})])),_:1},16,["model"]),c(E,{visible:l.value,"onUpdate:visible":a[5]||(a[5]=e=>l.value=e),title:i.value,centered:"",onOk:I},{default:g((()=>[c(s,{value:r.value,"onUpdate:value":a[4]||(a[4]=e=>r.value=e),placeholder:"请输入CD-KEY密钥",size:"large"},null,8,["value"])])),_:1},8,["visible","title"])],64)}}};export{W as _,H as b};
